{% extends "base.html" %}
{% block title %}Listado de Doctores{% endblock %}

{% block content %}
<div class="card mt-4">
  <div class="card-header d-flex justify-content-between align-items-center bg-dark text-white">
    <h5 class="mb-0 d-flex align-items-center gap-2">üë®‚Äç‚öïÔ∏è Listado de Doctores</h5>
    <a href="{{ url_for('nuevo_doctor') }}" class="btn btn-success btn-sm">
      ‚ûï Nuevo doctor
    </a>
  </div>

  <div class="card-body">
    <div class="table-responsive">
      <table id="tabla-doctores" class="table table-bordered table-striped table-hover table-sm text-center align-middle">
        <thead class="table-secondary">
          <tr>
            <th>Nombre</th>
            <th>C√©dula</th>
            <th>Especialidad</th>
            <th>Tel√©fono</th>
            <th>Turno</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          {% for doctor in doctores %}
          <tr>
            <td>{{ doctor.nombre }}</td>
            <td>{{ doctor.cedula if doctor.cedula else '-' }}</td>
            <td>{{ doctor.especialidad if doctor.especialidad else '-' }}</td>
            <td>{{ doctor.telefono if doctor.telefono else '-' }}</td>
            <td class="text-dark">{{ doctor.turno if doctor.turno else '-' }}</td>
            <td>
              <div class="d-flex justify-content-center gap-2">
                <!-- Editar -->
                <a href="{{ url_for('editar_doctor', id=doctor.id) }}" 
                   class="btn btn-warning btn-sm d-flex align-items-center gap-1 px-3">
                  <i class="bi bi-pencil"></i> Editar
                </a>
                <!-- Ver -->
                <a href="{{ url_for('ver_doctor', id=doctor.id) }}" 
                   class="btn btn-info btn-sm d-flex align-items-center gap-1 px-3">
                  <i class="bi bi-eye"></i> Ver
                </a>
                <!-- Eliminar (formato unificado con data-action y data-confirm) -->
                <a href="#"
                   class="btn btn-danger btn-sm d-flex align-items-center gap-1 px-3 btn-eliminar"
                   data-action="{{ url_for('eliminar_doctor', id=doctor.id) }}"
                   data-confirm="¬øSeguro que deseas eliminar este doctor?">
                  <i class="bi bi-trash"></i> Eliminar
                </a>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  $(function() {
    $('#tabla-doctores').DataTable({
      order: [[0, 'asc']],
      language: {
        search: "Buscar:",
        lengthMenu: "Mostrar _MENU_ registros",
        info: "Mostrando _START_ a _END_ de _TOTAL_ registros",
        infoEmpty: "Mostrando 0 a 0 de 0 registros",
        infoFiltered: "(filtrado de _MAX_ registros totales)",
        zeroRecords: "No se encontraron resultados",
        paginate: { 
          first: "Primero", 
          last: "√öltimo", 
          next: "Siguiente", 
          previous: "Anterior" 
        }
      }
    });
    // No hace falta duplicar el handler de eliminar aqu√≠,
    // porque ya lo tienes global en base.html capturando .btn-eliminar
  });
</script>
{% endblock %}
